<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTの文档小站</title>
    <style>
        :root {
            /* 日间模式变量 */
            --primary-blue: #2c3e50;
            --accent-blue: #3498db;
            --light-bg: rgba(248, 249, 250, 0.85);
            --text-dark: #34495e;
            
            /* 夜间模式变量 */
            --night-bg: #1a1a1a;
            --night-text: #e0e0e0;
            --night-primary: #2c3e50;
            --night-accent: #3498db;
            --night-border: #404040;
            --night-layer-1: rgba(30, 30, 30, 0.95);
            --night-layer-2: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s ease, color 0.2s ease, border-color 0.3s ease;
        }

        body {
            line-height: 1.6;
            color: #333;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            position: relative;
            transition: background-image 0.5s ease-in-out;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.85);
            z-index: -1;
            pointer-events: none;
        }

        /* 夜间模式全局样式 */
        body.night-mode {
            --primary-blue: var(--night-primary);
            --accent-blue: var(--night-accent);
            --text-dark: var(--night-text);
            --light-bg: var(--night-layer-1);
            color: var(--night-text);
        }
        body.night-mode::after {
            background: rgba(0, 0, 0, 0.85);
        }

        /* 侧边栏夜间模式 */
        .night-mode .sidebar {
            background: var(--night-layer-1);
            border-right-color: var(--night-border);
        }
        .night-mode .sidebar-header {
            color: var(--accent-blue);
        }
        .night-mode .sidebar-nav a {
            color: rgba(255, 255, 255, 0.8);
        }
        .night-mode .sidebar-nav a:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        .night-mode .submenu {
            background: var(--night-layer-2);
        }
        .night-mode .has-submenu > a::after {
            filter: invert(0.8);
        }

        /* 其他原有样式保持不变... */
        /* [原有全部CSS内容] */
        
        /* 新增主题切换按钮 */
        .theme-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            margin-left: 20px;
            font-size: 1.2rem;
            transition: transform 0.3s;
            will-change: transform;
        }
        .theme-toggle:hover {
            transform: rotate(15deg);
        }
        .night-icon { display: none; }
        .night-mode .day-icon { display: none; }
        .night-mode .night-icon { display: inline; }
    </style>
</head>
<body>
    <!-- [原有全部HTML结构] -->
    <!-- 在navbar-content内添加切换按钮 -->
    <div class="navbar-content">
        <!-- 原有内容... -->
        <button class="theme-toggle" aria-label="切换主题">
            <span class="day-icon">🌞</span>
            <span class="night-icon">🌙</span>
        </button>
    </div>

    <script>
        // [原有壁纸管理代码]
        
        // 新增主题控制模块
        const themeManager = {
            init() {
                this.toggleBtn = document.querySelector('.theme-toggle');
                this.loadTheme();
                this.bindEvents();
            },
            
            loadTheme() {
                const savedTheme = localStorage.getItem('theme') || 
                                  (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'night' : 'light');
                if (savedTheme === 'night') document.body.classList.add('night-mode');
            },
            
            bindEvents() {
                this.toggleBtn.addEventListener('click', () => {
                    document.body.classList.toggle('night-mode');
                    const currentTheme = document.body.classList.contains('night-mode') ? 'night' : 'light';
                    localStorage.setItem('theme', currentTheme);
                    
                    // 同步更新菜单状态
                    document.querySelectorAll('.has-submenu.active').forEach(item => {
                        item.style.backgroundColor = currentTheme === 'night' 
                            ? 'rgba(255,255,255,0.05)' 
                            : '';
                    });
                });
            }
        };

        // 初始化所有模块
        window.addEventListener('DOMContentLoaded', () => {
            // [原有初始化代码]
            themeManager.init();
        });
    </script>
</body>
</html>